<h1>投稿を編集する</h1>

<% if @dinner.errors.any? %>
  <div class="error-messages">
    <h2><%= pluralize(@dinner.errors.count, "件のエラー") %>が発生しています:</h2>
    <ul>
      <% @dinner.errors.full_messages.each do |message| %>
        <li><%= message %></li>
      <% end %>
    </ul>
  </div>
<% end %>

<% if @dinner.image.attached? %>
  <p>現在の画像：</p>
  <%= image_tag @dinner.image.variant(resize_to_limit: [300, 300]) %>
<% end %>

<%= form_with model: @dinner, local: true do |f| %>
  <p>
    <%= f.label :image, "新しい画像を選ぶ" %><br>
    <%= f.file_field :image %>
  </p>

  <p>
    <%= f.label :title %><br>
    <%= f.text_field :title %>
  </p>

  <p>
    <%= f.label :body %><br>
    <%= f.text_area :body %>
  </p>

  <p>
    <%= f.label :recipe_ids, "紐づけるレシピを選ぶ" %><br>
    <% @my_recipes.each do |recipe| %>
      <%= check_box_tag "dinner[recipe_ids][]", recipe.id, @dinner.recipes.include?(recipe), id: "recipe_#{recipe.id}" %>
      <%= label_tag "recipe_#{recipe.id}", recipe.title %><br>
    <% end %>
  </p>

  <p>
    <%= f.submit "更新する" %>
  </p>
<% end %>

<%= link_to '戻る', dinner_path(@dinner) %>
